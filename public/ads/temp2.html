
<html>

<head>
  <title>
    东翔超市
  </title>
  <!--<meta name="author" content="m.facdor.com">-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <meta http-equiv="Content-Type" content="text/html; charset=GBK">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="format-detection" content="telephone=no">
  <meta http-equiv="Expires" content="-1">
  <meta http-equiv="Cache-Control" content="no-cache">
  <meta http-equiv="Pragma" content="no-cache">
  <meta name="description" content="东翔超市" />
  <meta name="Keywords" content="东翔超市" />
  <script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.js"></script>
  <link rel="stylesheet" href="http://static.360buyimg.com/panda_cube/channel/dist/v20151209/t_base-min.css" />
  <link rel="stylesheet" href="/css/ads.css" type="text/css" />
</head>

<body>

<div class="logo-banner">
  <img src="/images/logo-banner.png" />
</div>
<div class="t_module t_slider_banner">
  <div class="banner_list jsSlider">
    <ul class="clear">
      <li>
        <div href='' class="J_ping">
          <img src="http://img11.360buyimg.com/jshopm/jfs/t2350/205/1096317819/97231/3531446f/5677e4deN32866ac6.jpg" alt="" lazy-img="jd-app"  img-size="1065,315"/>
        </div>
      </li>
      <li>
        <div href='' class="J_ping">
          <img src="http://img10.360buyimg.com/jshopm/jfs/t2518/8/984245958/63523/688b5434/567d2f5cN202b6aa9.jpg" alt="" lazy-img="jd-app"  img-size="1065,315"/>
        </div>
      </li>
      <li>
        <div href='' class="J_ping">
          <img src="http://img20.360buyimg.com/jshopm/jfs/t2323/86/1735911988/98752/f1da9ce0/567919d9N05de5fbb.jpg" alt="" lazy-img="jd-app"  img-size="1065,315"/>
        </div>
      </li>
      <li>
        <div href='' class="J_ping">
          <img src="http://img30.360buyimg.com/jshopm/jfs/t2107/302/1081110179/95624/9bf8349/5679fb79N091d70cc.jpg" alt="" lazy-img="jd-app"  img-size="1065,315"/>
        </div>
      </li>
    </ul>
    <div class="banner_point"></div>
  </div>
</div>


<div class="categories">
  <ul id="product-category" class="category-tab">
    <li><a data-category="all" href="" class="selected">全部</a></li>
    <li><a data-category="生鲜" href="">生鲜</a></li>
    <li><a data-category="食品" href="">食品</a></li>
    <li><a data-category="用品" href="">用品</a></li>
  </ul>
</div>

<div class="t_product-list">
  <div id="products" class="block_grid_2 j_product-list"></div>
</div>

<script id="product-template" type="text/template">
  <div class="grid j_grid " data-product-id="{{index}}">
    <a href="#" class="item p-item J_ping" report-eventid="MTopic_recommend" link-transform="true">
      <div class="img_grid">
        <img class="samLazyImg" src="/images/placeholder.png" data-src="{{imgUrl}}" alt="" img-type="product" data-img-hide="false" load="true">
      </div>
      <p class="txt">{{name}}</p>
      <div class="price_area">
        <p class="price"><strike class="crossout">¥234.00</strike> ¥{{price}}</p>
      </div>
    </a>
  </div>
</script>

<script type="text/javascript" src="/lib/tab.js"></script>
<script type="text/javascript">
  var renderProducts = function(products) {
    var newContent = '';
    var selectedCategory = CategoryTab.activeTab.attr('data-category');
    products.map(function(product, index) {
      var prodTemplate = $('#product-template');
      newContent += prodTemplate.html()
              .replace(/{{index}}/ig, index)
              .replace(/{{name}}/ig, product.name)
              .replace(/{{imgUrl}}/ig, product.imgUrl)
              .replace(/{{price}}/ig, product.price);
    });
    $('#products').html(newContent);
  };

  var products = [
    {
      name: '营养土鸡蛋',
      imgUrl: '/images/products/eggs.jpeg',
      price: '90.00/斤',
      categories: ['生鲜']
    }, {
      name: '中国香米',
      imgUrl: '/images/products/rice.jpeg',
      price: '90.00/斤',
      categories: ['生鲜']
    }, {
      name: '香芹',
      imgUrl: '/images/products/chinese-celery.jpg',
      price: '5.00/斤',
      categories: ['生鲜']
    }, {
      name: '东北大白菜',
      imgUrl: '/images/products/chinese-cabage.jpeg',
      price: '2.98/斤',
      categories: ['生鲜']
    }, {
      name: '99长城干红 750毫升',
      imgUrl: '/images/products/wine-cc-gh-750ml.jpg',
      price: '90.00',
      categories: ['食品']
    },{
      name: '德芙心语巧克力 98克',
      imgUrl: '/images/products/dove-xy-98g.jpg',
      price: '44.50',
      categories: ['食品']
    },{
      name: '伊利纯牛奶 250毫升*16盒',
      imgUrl: '/images/products/yili-milk-6x250ml.jpg',
      price: '44.50',
      categories: ['食品']
    }, {
      name: '罐装王老吉 310毫升',
      imgUrl: '/images/products/wanglaoji-310ml.jpg',
      price: '259.00',
      categories: ['食品']
    }, {
      name: '可口可乐 雪碧 2升装',
      imgUrl: '/images/products/coke-sprite-2l.jpg',
      price: '259.00',
      categories: ['食品']
    }, {
      name: '百威啤酒 600毫升 瓶装',
      imgUrl: '/images/products/baiwei-beer-600ml.jpg',
      price: '1259.00',
      categories: ['食品']
    }, {
      name: '金龙鱼食用调和油 5升装',
      imgUrl: '/images/products/jly-mixed-oil-5l.jpg',
      price: '234.99',
      categories: ['食品']
    },{
      name: '旺旺雪饼 84克',
      imgUrl: '/images/products/wangwang-84g.jpg',
      price: '259.00',
      categories: ['食品']
    }, {
      name: '舒肤佳纯白沐浴露 720毫升',
      imgUrl: '/images/products/safeguard-body-wash-720ml.jpg',
      price: '1259.00',
      categories: ['用品']
    }, {
      name: '飘柔焗油去屑洗发露 200毫升',
      imgUrl: '/images/products/rejoice-200ml.jpg',
      price: '234.99',
      categories: ['用品']
    },{
      name: '清风冬夏卷纸 10卷',
      imgUrl: '/images/products/breeze-bath-tissue-10-roles.jpg',
      price: '259.00',
      categories: ['用品']
    }, {
      name: '黑人双重薄荷牙膏 90克',
      imgUrl: '/images/products/darlie-tooth-paste-90g.jpeg',
      price: '1259.00',
      categories: ['用品']
    }, {
      name: '立白超洁清新洗衣粉 1.068千克',
      imgUrl: '/images/products/liby-detergent-1068g.jpeg',
      price: '234.99',
      categories: ['用品']
    },{
      name: '立白金桔洗洁精 1.29千克',
      imgUrl: '/images/products/liby-jj-dish-liquid-1290g.jpeg',
      price: '259.00',
      categories: ['用品']
    }, {
      name: '深层洁净亮白增艳洗衣液 薰衣草香 2千克',
      imgUrl: '/images/products/blue-moon-detegent-2l.jpeg',
      price: '1259.00',
      categories: ['用品']
    }, {
      name: '六神Liushen 驱蚊花露水195毫升',
      imgUrl: '/images/products/liushen-195ml.jpeg',
      price: '10.99',
      categories: ['用品']
    }
  ];

  renderProducts(products);
  $('.square').each(function() {
    $(this).height($(this).width());
  });

  var lazyload = {
    init : function(opt){
      var that = this,
              op = {
                anim: true,
                extend_height:0,
                selectorName:"img",
                realSrcAtr:"data-src"
              };
      // 合并对象，已有的{anim:true}+用户自定义对象。也就是op = op + opt
      $.extend(op,opt);
      // 调用lazyload.img.init(op)函数
      that.img.init(op);

    },

    img : {
      init : function(n){

        var that = this,
                selectorName = n.selectorName,
                realSrcAtr = n.realSrcAtr,
                anim = n.anim;
//              console.log(n);

        // 要加载的图片是不是在指定窗口内
        function inViewport( el ) {
          // 当前窗口的顶部
          var top = window.pageYOffset,
          // 当前窗口的底部
                  btm = window.pageYOffset + window.innerHeight,
          // 元素所在整体页面内的y轴位置
                  elTop = $(el).offset().top;
          // 判断元素，是否在当前窗口，或者当前窗口延伸400像素内
          return elTop >= top && elTop - n.extend_height <= btm;
        }

        // 滚动事件里判断，加载图片
        $(window).on('scroll', function() {
          $(selectorName).each(function(index,node) {
            var $this = $(this);

            if(!$this.attr(realSrcAtr) || !inViewport(this)){
              return;
            }

            act($this);

          })
        }).trigger('scroll');

        // 展示图片
        function act(_self){
          // 已经加载过了，则中断后续代码
          if (_self.attr('lazyImgLoaded')) return;
          var img = new Image(),
                  original = _self.attr('data-src');
          // 图片请求完成后的事件，把dataimg指定的图片，放到src里面，浏览器显示
          img.onload = function() {
            _self.attr('src', original);
            anim && _self.css({ opacity: .2 }).animate({ opacity: 1 }, 280);
          };
          // 当你设置img.src的时候，浏览器就在发送图片请求了
          original && (img.src = original);
          _self.attr('lazyImgLoaded', true);
        }
      }
    }
  };

  lazyload.init({
    selectorName:".samLazyImg"
  });

  var filter = function() {
    var productDivs = $('#products > div');
    productDivs.each(function() {
      productDiv = $(this);
      var selectedCategory = CategoryTab.activeTab.attr('data-category');
      var product = products[productDiv.attr('data-product-id')];
      var v = selectedCategory === 'all' || ($.isArray(product.categories) && $.inArray(selectedCategory, product.categories) !== -1);
      if (v) productDiv.show();
      else productDiv.hide();
    });
    $(window).scroll();
  };

  CategoryTab.onTabSwitch = filter;
  filter();

</script>
<script type="text/javascript" src="/lib/slideshow.js"></script>

</body>

</html>